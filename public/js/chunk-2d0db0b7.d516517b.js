(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0db0b7"],{"6dd7":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h3",[t._v("Загрузить товары")]),i("div",[i("div",[i("v-select",{attrs:{items:t.providers,"item-text":"nameProvider","item-value":"id","persistent-hint":"","return-object":"","single-line":"",label:"Провайдер"},on:{change:t.reset},model:{value:t.idProvider,callback:function(e){t.idProvider=e},expression:"idProvider"}})],1),i("label",[t._v("File "),i("input",{ref:"file",attrs:{type:"file",id:"file"},on:{change:function(e){return t.handleFileUpload(e)}}})]),i("div",{staticClass:"my-10"},[i("v-btn",{attrs:{disabled:!this.file},on:{click:function(e){return t.submitFile()}}},[t._v("Submit")]),t._v(" "+t._s(t.showStatus)+" ")],1)]),t.contentFile?i("div",[i("h3",[t._v("Products from files")]),i("div",[t.idProvider&&t.headers&&t.contentFile?i("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.contentFile,"items-per-page":5}}):t._e()],1),i("v-btn",{staticClass:"mt-10",attrs:{color:"primary"},on:{click:t.save}},[t._v("Сохранить")]),t._v(" "+t._s(t.saveStatus)+" ")],1):t._e()])},a=[],r=i("5530"),o=(i("159b"),i("d81d"),i("bc3a")),l=i.n(o),s=i("2f62"),d={name:"AddProducts",components:{},data:function(){return{file:null,readFromFile:null,added:null,error:null,idProvider:null,contentFile:null,providers:null,showStatus:null,saveStatus:null}},computed:Object(r["a"])(Object(r["a"])({},Object(s["c"])(["doubleCount"])),{},{provider:function(){var t=this;if(!this.idProvider||!this.idProvider.id||!this.providers)return null;var e=null;return this.providers.forEach((function(i){i.id===t.idProvider.id&&(e=i)})),e},headers:function(){if(!this.provider||!this.provider.fieldsNames)return null;var t=JSON.parse(this.provider.fieldsNames);return t.map((function(t){return{text:t,align:"start",value:t}}))}}),mounted:function(){var t=this;l.a.get("http://localhost:3000/api/getProviders",{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){e&&e.data&&e.data.data&&(t.providers=e.data.data)})).catch((function(){console.log("ERROR"),t.providers=null}))},methods:{handleFileUpload:function(){this.file=this.$refs.file.files[0]},submitFile:function(){var t=this;this.error=null,this.readFromFile=null,this.added=null;var e=new FormData;console.log(this.file),e.append("file1",this.file),e.append("idProvider",this.idProvider&&this.idProvider.id),l.a.post("http://localhost:3000/api/readProviderFile",e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){console.log(e.data.readFromFile),console.log("SUCCESS"),t.showStatus="Успешно загружен файл",t.contentFile=e&&e.data})).catch((function(){console.log("ERROR"),t.showStatus="Ошиюка загрузки файла",t.contentFile=null}))},save:function(){var t=this;this.contentFile||console.log("empty content"),l.a.post("http://localhost:3000/api/addProviderProducts",{rows:this.contentFile.map((function(e){var i=JSON.parse(t.provider.fieldsNames);return Object(r["a"])(Object(r["a"])({},e),{},{idProductProvider:e["innerId"],values:JSON.stringify(i.map((function(t){return e[t]})))})}))},{headers:{"Content-Type":"application/json"}}).then((function(e){console.log("SUCCESS"),t.saveStatus="Успешно сохранено"+JSON.stringify(e&&e.data,null,2),console.log(e)})).catch((function(){console.log("ERROR"),t.saveStatus="Ошибка при сохранении"}))},reset:function(){this.showStatus="",this.saveStatus="",this.contentFile=null}}},u=d,c=i("2877"),v=i("6544"),h=i.n(v),p=i("8336"),f=i("8fea"),m=i("b974"),b=Object(c["a"])(u,n,a,!1,null,null,null);e["default"]=b.exports;h()(b,{VBtn:p["a"],VDataTable:f["a"],VSelect:m["a"]})}}]);
//# sourceMappingURL=chunk-2d0db0b7.d516517b.js.map